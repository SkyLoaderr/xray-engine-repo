local stalkers = {
                 {name = "stalker1",  id = -1},
                 {name = "stalker2",  id = -1},
                 {name = "stalker3",  id = -1},
                 {name = "stalker4",  id = -1},
                 {name = "stalker5",  id = -1},
                 {name = "stalker6",  id = -1},
                 {name = "stalker7",  id = -1},
                 {name = "stalker8",  id = -1},
                 {name = "stalker9",  id = -1},
                 {name = "stalker10",  id = -1}
                 }
local indices = {}                 
                 
local last_time = 0

-------------------------------------------------------------------------------------
function main ()
    if table.getn (stalkers) == 0 then return end
    --fill the id's
    for a = 1, table.getn (stalkers), 1 do
        local npc = get_level_object (stalkers[a].name)
        printf ("GETTING STALKER %s", stalkers[a].name)
        stalkers[a].id = npc:id ()
        this.switch_offline (a)
    end    
        
    local scr_zone = get_level_object ("bar_zone")
    scr_zone:set_callback (this.on_enter, true)
    scr_zone:set_callback (this.on_exit,  false)
    
    while true do
          wait ()
    end      
end
-------------------------------------------------------------------------------------
function on_enter (zone, obj)
    local act = level.actor ()
    if act == nil or obj:id () ~= act:id () then return  end
    if game.time () - last_time > (12 * 60 * 60 * 1000) or table.getn (indices) == 0 then
       this.rechange ()
    end   
    
    for a = 1, table.getn (indices), 1 do
        this.switch_online (indices[a])
    end
end
-------------------------------------------------------------------------------------
function on_exit (zone, obj)
    local act = level.actor ()
    if act == nil or obj:id () ~= act:id () then return  end
    for a = 1, table.getn (indices), 1 do
        this.switch_offline (indices[a])
    end
    last_time = game.time ()
end
-------------------------------------------------------------------------------------
function rechange ()
    local num = table.getn (stalkers) / 2
    indices = {}
    local a = 0
    while a ~= num do
          local index = math.random (1, table.getn (stalkers))
          if this.present (index) == false then
             a = a + 1
             table.insert (indices, index)
          end
    end          
end
-------------------------------------------------------------------------------------
function present (index)
    for a = 1, table.getn (indices), 1 do
        if index == indices[a] then return true end
    end
    return false    
        
end
-------------------------------------------------------------------------------------
function switch_online (a)
    local sim = alife ()
    if sim ~= nil then
       sim:set_switch_online  (stalkers[a].id, true) 
       sim:set_switch_offline (stalkers[a].id, false)
       printf ("Object %s move to online at %d time", stalkers[a].name, device ():time_global ())
    end       
end
-------------------------------------------------------------------------------------------
function switch_offline (a)

    local sim = alife ()
    if sim ~= nil then
       sim:set_switch_online  (stalkers[a].id, false) 
       sim:set_switch_offline (stalkers[a].id, true)
       printf ("Object %s move to offline at %d time", stalkers[a].name, device ():time_global ())
    end       
end
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
