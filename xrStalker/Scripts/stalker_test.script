function action(obj,...)
	local act = entity_action()
	local i = 1
	while true do
		if (arg[i] ~= nil) then
			act:set_action(arg[i])
		else
			break
		end
		i = i + 1
	end
	if (obj ~= nil) then
		obj:command(act,false)
	end
	return	entity_action(act)
end

function action_first(obj,...)
	local act = entity_action()
	local i = 1
	while true do
		if (arg[i] ~= nil) then
			act:set_action(arg[i])
		else
			break
		end
		i = i + 1
	end
	if (obj ~= nil) then
		obj:command(act,true)
	end
	return	entity_action(act)
end

function main ()
    stalker			= get_level_object ("m_stalker_e0000")
    stalker:script	(true,stalker_test:script_name());
    
--	action(                                                                                                       
--	    stalker,                                                                                                      
--	  	look		(look.point,get_level_object("localhost/dima")),
--	 	sound		("simple_detector_noise","bip01_spine2",vector():set(0,0,0),vector():set(0,0,0),true),
--		particle	("vehiclefx\\exhaust_1","bip01_head",particle_params(vector():set(0,0,0.3),vector():set(0,0,0),vector():set(1,0,0)),false),
--		object		(wpn,object.activate),
--	    anim		(anim.danger),
--		move		(move.standing,move.run,move.line,get_level_object("localhost/dima")),
--		cond		(cond.move_end)
--	)
--	a				= patrol("way0000")
--	n				= a:count();
--	i				= 0;
--	while i<n do
--		c			= a:point(i);
--		printf		("[%f][%f][%f]",c.x,c.y,c.z)
--		i			= i + 1
--	end
--
--	c				= a:point(a:nearest(get_level_object("localhost/dima"):position()));
--	printf			("nearest : [%f][%f][%f]",c.x,c.y,c.z)
	
--	action(
--	    stalker,                                                                                                      
--		move		(move.standing, move.walk, move.line, patrol ("way0000")),
--		look		(look.fire_point, get_level_object("localhost/dima")),
--		look		(look.path_dir),
--		anim		(anim.free),
--		cond		(cond.move_end)
--	)

	stalker_test:action (
		stalker, 
		move		(move.standing, move.walk, move.line, patrol ("way0000")),
		look		(look.path_dir),
		anim		(anim.danger),
		cond		(cond.move_end)
	)
	
	wait			(2000)
	
	stalker_test:action_first (
		stalker, 
		move		(move.standing, move.stand, move.line, patrol ("way0000")),
		anim		("stoya_ruje_ 0"),
		cond		(cond.time_end, 10000)
	)
	
	while stalker:action() do
		wait		();
	end
	
    stalker:script	(false,stalker_test:script_name());
end